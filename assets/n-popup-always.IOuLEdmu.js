import{r as e,c as t,J as a,K as l,d as o,w as u,i as n,o as v,n as s,H as i,m as r,N as p,f as c,e as f}from"./index-DyB-GtSf.js";import{m}from"./props.CkprGx8I.js";import{g as h,b as x}from"./system.Bdz65IDa.js";const g={__name:"n-popup-always",props:m([["show",!1],["pos","bottom"],"bgType",["duration",300],["hasOverlay",!0],["overlay",{hasAnimation:!0,timingFunction:["ease-in","ease-out"],duration:300,bg:"",bgType:"mask"}],["ani",{timingFunction:"ease-out"}],["baseWidth","750rpx"],["baseHeight","window"],["width","750rpx"],["height","0"],["standout","0"],["leftOffset","-1"],["rightOffset","-1"],["bottomOffset","-1"],["topOffset","-1"],["left","0"],["right","0"],["top","0"],["bottom","0"],["initWithAni",!0],["initDelay",200],["initDuration",300],"boxStyle","overlayClass","boxClass"]),emits:["overlayClicked"],setup(m,{emit:g}){const y=m,b=g;e(!1),e(!1);const d=e(""),$=e(""),k=e(!1),O=e(null),w=e(null),C=t((()=>h(y.baseHeight))),T=t((()=>h(y.baseWidth))),_=t((()=>{let e={width:`${X.value}px`,height:`${W.value}px`};const t=y.pos;t.endsWith("center")&&("center"===t||"scale-center"===t?(e.left=.5*(T.value-X.value)+"px",j.value<0&&H.value<0?e.top=.5*(C.value-W.value)+"px":j.value>=0?e.top=.5*(C.value-W.value)+j.value+"px":H.value>=0&&(e.top=.5*(C.value-W.value)-H.value+"px"),"center"===t&&(e.opacity=0,e.transform="scale(0,0)"),"scale-center"===t&&(e.transform="scale(0,0)")):"left-center"===t||"right-center"===t?(j.value<0&&H.value<0?e.top=.5*(C.value-W.value)+"px":j.value>=0?e.top=.5*(C.value-W.value)+j.value+"px":H.value>=0&&(e.top=.5*(C.value-W.value)-H.value+"px"),"left-center"===t&&(e.left=-X.value+"px"),"right-center"===t&&(e.right=-X.value+"px")):"top-center"!==t&&"bottom-center"!==t||(e.left=.5*(T.value-X.value)+"px","top-center"===t&&(e.top=-W.value+"px"),"bottom-center"===t&&(e.bottom=-W.value+"px"))),"top"!==t&&"bottom"!==t||(P.value<0&&A.value<0?e.left=.5*(T.value-z.value-S.value-X.value)+"px":P.value>=0?e.left=z.value+P.value+"px":A.value>=0&&(e.right=S.value+A.value+"px"),"top"===t&&(e.top=-W.value+"px"),"bottom"===t&&(e.bottom=-W.value+"px")),"left"!==t&&"right"!==t||(j.value<0&&H.value<0?e.top=.5*(C.value-K.value-J.value-W.value)+"px":j.value>=0?e.top=K.value+j.value+"px":H.value>=0&&(e.bottom=J.value+H.value+"px"),"left"===t&&(e.left=-X.value+"px"),"right"===t&&(e.right=-X.value+"px"));let a="";for(const l in e)a+=l+":"+e[l]+";";return a})),F=t((()=>C.value-K.value-J.value)),D=t((()=>`left:${z.value}px;top:${K.value}px;right:${S.value}px;`)),W=t((()=>{if(1*y.height>0&&1*y.height<=1)return C.value*(1*y.height);const e=h(y.height);return e>1?e:e<=0?C.value-K.value-J.value-(j.value>=0?j.value:0)-(H.value>=0?H.value:0):C.value*e})),X=t((()=>{const e=x(y.width);return e<=0?T.value-z.value-S.value-(P.value>=0?P.value:0)-(A.value>=0?A.value:0):e})),Y=t((()=>h(y.standout))),P=t((()=>"-1"===y.leftOffset?-1:x(y.leftOffset))),j=t((()=>"-1"===y.topOffset?-1:h(y.topOffset))),A=t((()=>"-1"===y.rightOffset?-1:x(y.rightOffset))),H=t((()=>"-1"===y.bottomOffset?-1:h(y.bottomOffset))),z=t((()=>x(y.left))),K=t((()=>h(y.top))),S=t((()=>x(y.right))),J=t((()=>h(y.bottom)));function M(){let e=0;y.initWithAni&&(e=y.initDuration||0),d.value=`transition-property: transform;transition-duration:${e}ms;transition-timing-function: ${y.ani.timingFunction};transform:translate${"top"==y.pos||"bottom"==y.pos?"Y":"X"}(${"top"==y.pos||"left"==y.pos?Y.value:-1*Y.value}px);`}function N(e){e.stopPropagation&&e.stopPropagation(),k.value&&b("overlayClicked",{})}function q(e){e.stopPropagation&&e.stopPropagation()}return a((()=>y.show),(e=>{(function(e,t=y.duration){!function(e,t=y.duration){k.value=e;let a="transition-duration:"+t+"ms;";if(a+="transition-timing-function:"+y.ani.timingFunction+";","center"===y.pos?(a+=e?"transform: scale(1,1);":"",a+="transition-property:opacity;",a+="opacity:"+(e?1:0)+";"):(a+="transition-property:transform;",a+="transform:"+function(e,t){let a=Y.value,l="";switch(e){case"top":t||(a=W.value+K.value+(j.value>=0?j.value:0)),l=`translateY(${a}px)`;break;case"bottom":t||(a=W.value+J.value+(H.value>=0?H.value:0)),l=`translateY(-${a}px)`;break;case"left":t||(a=X.value+z.value+(P.value>=0?P.value:0)),l=`translateX(${a}px)`;break;case"right":t||(a=X.value+S.value+(A.value>=0?A.value:0)),l=`translateX(-${a}px)`;break;case"scale-center":l=t?"scale(0,0)":"scale(1,1)";break;case"left-center":t||(a=.5*(T.value+X.value)),l=`translateX(${a}px)`;break;case"right-center":t||(a=.5*(T.value+X.value)),l=`translateX(-${a}px)`;break;case"top-center":t||(j.value<0&&H.value<0?a=.5*(C.value+W.value):j.value>=0?a=.5*(C.value+W.value)+j.value:H.value>=0&&(a=.5*(C.value+W.value)-H.value)),l=`translateY(${a}px)`;break;case"bottom-center":t||(j.value<0&&H.value<0?a=.5*(C.value+W.value):j.value>=0?a=.5*(C.value+W.value)-j.value:H.value>=0&&(a=.5*(C.value+W.value)+H.value)),l=`translateY(-${a}px)`}return l}(y.pos,!e)+";"),d.value=a,!y.hasOverlay)return;let l="transition-duration:"+y.overlay.duration+"ms;";e&&(l+=`height:${F.value}px;`),l+="transition-timing-function:"+(e?y.overlay.timingFunction[0]:y.overlay.timingFunction[1])+";",l+="transition-property:opacity;",l+="opacity:"+(e?1:0)+";",$.value=l,setTimeout((()=>{!e&&($.value="")}),y.overlay.duration)}(e,t)})(e)})),l((()=>{Y.value<=0||(y.initDelay>=0?setTimeout((()=>{M()}),y.initDelay):M())})),(e,t)=>{const a=n;return v(),o(a,null,{default:u((()=>[e.hasOverlay?(v(),o(a,{key:0,ref_key:"npopooverlay",ref:w,class:s(["n-position-fixed","n-height-0","n-opacity-0","n-zindex-pop-always-overlay","n-bg-"+e.overlay.bgType,e.overlayClass]),onTouchmove:i(q,["stop"]),onClick:i(N,["stop"]),style:r(D.value+$.value)},{default:u((()=>[p(e.$slots,"overlay")])),_:3},8,["class","style"])):c("",!0),f(a,{ref_key:"npopo",ref:O,onTouchmove:i(q,["stop"]),onClick:i(q,["stop"]),class:s(["n-position-fixed","n-width-750rpx","n-zindex-pop-always","n-flex-column","n-bg-"+e.bgType,e.boxClass]),style:r(e.boxStyle+_.value+d.value)},{default:u((()=>[p(e.$slots,"default")])),_:3},8,["class","style"])])),_:3})}}};export{g as _};
