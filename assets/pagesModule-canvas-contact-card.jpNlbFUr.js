import{r as t,I as e,c as a,E as n,aD as s,aa as l,b as i,d as o,w as c,i as r,o as p,e as f,j as m,m as u,h,ae as F,aB as d,aC as v,aE as x,a6 as g}from"./index-DyB-GtSf.js";import{_ as y}from"./n-navbar.DgJOiXYI.js";import{o as _,r as S}from"./uni-app.es.CYr7Wecl.js";import{u as P}from"./useNav.y5ABEmWP.js";import{c as I}from"./imgs.wUGTdslH.js";import{_ as T}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./n-icon.C34IfF9H.js";import"./props.CkprGx8I.js";import"./n-badge.U9JWwHKe.js";import"./system.Bdz65IDa.js";const w=T({__name:"contact-card",setup(T){const{leftIcons:w,navLeftAction:j}=P(),b=t(0),k=t(0);let M=!1;const z=e({mpWxQr:I.qr,invest_areas:[{id:1,name:"儿童教育"},{id:1,name:"少儿编程"},{id:1,name:"生物智能"},{id:1,name:"万物相连"},{id:1,name:"大数据"}],nickname:"热豆Wakary",avatar:I.logo,company:"热豆科技",phone:"17610998099",email:"redoume@163.com",location:"北京"}),A=a((()=>{if(z.invest_areas){const t=[];return z.invest_areas.forEach((e=>{t.push(e.name)})),t.join(" ")}return"未设置"}));function L(){M?d({canvasId:"mini_poster",success:t=>{v({filePath:t.tempFilePath,success:()=>{F({title:"保存成功"})},fail(){F({icon:"none",title:"保存名片码失败"})}})},fail(){F({icon:"none",title:"保存名片码失败"})}}):F({title:"正在生成图片，稍后再试",icon:"none"})}function R(){const t=s("test_poster"),e=n(34),a=B(t,"我是来自 "+z.company+" 的投资人"+z.nickname,e,0,b.value-2*e,26);return 2*e+n(380)+e+12+78+26*a+90}function W(t,e,a,n,s,l){t.beginPath(),t.arc(e+l,a+l,l,Math.PI,1.5*Math.PI),t.arc(e+n-l,a+l,l,1.5*Math.PI,2*Math.PI),t.arc(e+n-l,a+s-l,l,0,.5*Math.PI),t.arc(e+l,a+s-l,l,.5*Math.PI,Math.PI),t.closePath(),t.fillStyle="#FFFFFF",t.fill()}function B(t,e,a,n,s,l){const i=e.split("");let o="",c=[];for(let r=0;r<i.length;r++)t.measureText(o).width<s||(c.push(o),o=""),o+=i[r];c.push(o);for(const r in c)t.fillText(c[r],a,n+(1*r+1)*l);return c.length}function E(t){return new Promise(((e,a)=>{l({url:t,success:t=>e(t),fail:t=>a(t)})}))}return _((()=>{b.value=n(750),k.value=R(),async function(){const t=n(34),e=n(380),a=b.value-2*t;let l=s("mini_poster");l.setFillStyle("#F3F4F5"),l.fillRect(0,0,b.value,k.value);const i=n(12);(function(t,e,a,s,l,i,o){t.save(),W(t,e,a,s,l,i),t.clip(),t.fillStyle=z.company?"#F37231":"#333333";const c=n(12);t.fillRect(e,a,c,l),t.restore()})(l,t,t,a,e,i),async function(t,e,a,s,l){let i=a+n(45);const o=e+n(52);t.setTextBaseline("top");const c=n(30);t.fillStyle="#F5A623",t.setFontSize(c),t.fillText(z.company,o,i),i+=30;const r=n(50);t.setFillStyle("#333333"),t.setFontSize(r),t.fillText(z.nickname,o,i),i+=42;const p=n(30),f=o+p+6;t.drawImage("/static/canvas/position.png",o,i,p,p),t.setFillStyle("#333333"),t.setFontSize(c),t.fillText(z.location,f,i),i+=28,t.drawImage("/static/canvas/mouse-pointer.png",o,i,p,p),t.setFillStyle("#333333"),t.setFontSize(c);const m=n(34),u=n(40),h=s-f+m-u;(function(t,e,a,n,s){const l=e.split("");let i="";for(let o=0;o<l.length;o++){if(!(t.measureText(i+"...").width<=s)){i=i.substring(0,i.length-1),i+="...";break}i+=l[o]}t.fillText(i,a,n)})(t,A.value,f,i,h),i+=28,t.drawImage("/static/canvas/phone.png",o,i,p,p),t.setFillStyle("#333333"),t.setFontSize(c),t.fillText(z.phone?z.phone:"",f,i)}(l,t,t,a);const o=n(128),c=await E(z.avatar);if(c.tempFilePath){!function(t,e,a,n,s,l,i){t.save(),W(t,e,a,n,s,l),t.clip(),t.drawImage(i,e,a,n,s),t.restore()}(l,b.value-t-n(40)-o,t+n(40),o,o,i,c.tempFilePath)}if(async function(t,e,a,s){let l=a+12;const i=e;t.setTextBaseline("top");const o=n(30);t.setFillStyle("#333333"),t.setFontSize(o),t.fillText("您好，",i,l);const c="我是来自 "+z.company+" 的投资人"+z.nickname,r=B(t,c,i,l,s,26);l+=26*r+26,t.fillText("这是我的名片，请惠存。",i,l),l+=26,t.fillText("谢谢",i,l),l+=26,l+=40,t.setFillStyle("#F37231"),t.fillRect(i,l,20,3),l+=7,t.setFillStyle("#333333");const p=n(28);t.setFontSize(p),t.fillText("长按识别二维码",i,l),l+=20;const f="在nPro中查看我的更多信息";t.fillText(f,i,l)}(l,t,t+e+t,a),z.mpWxQr){const t=await E(z.mpWxQr),e=n(34),a=n(180),s=R();t.tempFilePath&&l.drawImage(t.tempFilePath,b.value-e-a,s-e-a,a,a)}l.draw(),M=!0}()})),(t,e)=>{const a=S(i("n-navbar"),y),n=x,s=r,l=g;return p(),o(s,null,{default:c((()=>[f(a,{lefts:m(w),title:"名片",onLeftAction:m(j)},null,8,["lefts","onLeftAction"]),f(s,null,{default:c((()=>[f(n,{"canvas-id":"mini_poster",style:u({width:b.value+"px",height:k.value+"px"})},null,8,["style"])])),_:1}),f(s,{style:{height:"106rpx"}}),f(s,{class:"footer"},{default:c((()=>[f(s,{style:{height:"106rpx","align-items":"center","background-color":"#333333"}},{default:c((()=>[f(l,{style:{background:"transparent",height:"106rpx","line-height":"106rpx",color:"#FFFFFF"},onClick:L},{default:c((()=>[h("保存名片")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-95628249"]]);export{w as default};
