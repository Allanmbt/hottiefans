import{at as t,I as e,c as i,b as o,d as s,w as a,i as n,o as r,e as l,j as c,k as m,l as p,F as h,m as g,O as u,E as f,v,ad as y,f as b}from"./index-DyB-GtSf.js";import{_ as d}from"./n-navbar.DgJOiXYI.js";import{o as x,d as S,r as V}from"./uni-app.es.CYr7Wecl.js";import{_ as j}from"./n-list-cell.CFZ1yxA_.js";import{_ as P}from"./n-list.qlhvrMMX.js";import{_ as H}from"./n-height.iPg7YRxT.js";import{i as T,_,a as w,b as M,c as k,m as E,d as L,e as A}from"./data.BtYriC70.js";import"./n-icon.C34IfF9H.js";import"./n-popup.DWLeKhpE.js";import{c as B}from"./imgs.wUGTdslH.js";import{u as C}from"./useNav.y5ABEmWP.js";import{c as I,d as Z}from"./system.Bdz65IDa.js";import{u as z}from"./element.B9OwrRfy.js";import"./n-badge.U9JWwHKe.js";import"./props.CkprGx8I.js";import"./usePager.Bx7XEHLh.js";import"./_plugin-vue_export-helper.BCo6x5W8.js";import"./n-button.C0Lbq8AA.js";import"./n-loading-indicator.BodNpqVl.js";const D={__name:"z-reverse-more",props:{type:{type:String,default:"1"}},setup(D){const{leftIcons:R,navLeftAction:K}=C(),N=t(),O=z(),q=[{icon:"add",text:"好友",iconType:"inverse",iconSize:"ss",textType:"inverse",textSize:"ss",textStyle:"margin-left:6rpx;",bgType:"error",style:"border-radius:60rpx;width:125rpx;height:25px;justify-content:center;"},{icon:"elipsis",style:"margin-left:36rpx;"}],F=e({hasMorePage:!1,items:[],kbH:0,kbHeight:0,otherHeight:0,voiceVisible:!1,plusVisible:!1,emotionVisible:!1,moreVisible:!1,playingSrc:"",xh:0,platform:"",cp:1}),Q=i((()=>F.kbHeight||F.otherHeight||0)),U=D;function W(t){}function G(t){F.hasMorePage?(F.items.unshift({id:2,avatar:B.avatar.caiman,type:"image",msg:t}),F.items.unshift({id:1,avatar:B.avatar.girl_nice,type:"image",msg:t}),u((function(){O.list.nScrollToTop()}))):(F.items.push({id:2,avatar:B.avatar.caiman,type:"image",msg:t}),F.items.push({id:1,avatar:B.avatar.girl_nice,type:"image",msg:t}),u((function(){O.list.nScrollToBottom()})))}function J(){F.voiceVisible=!F.voiceVisible,F.plusVisible=!1,F.emotionVisible=!1,F.voiceVisible?F.otherHeight=f(276)-F.xh:F.otherHeight=0}function X(){F.voiceVisible=!1,F.otherHeight=0}function Y(){F.voiceVisible=!1,F.otherHeight=0}function $(t){console.log(t),F.voiceVisible=!1,F.otherHeight=0,F.hasMorePage?(F.items.unshift({id:2,avatar:B.avatar.caiman,type:"voice",msg:t}),F.items.unshift({id:1,avatar:B.avatar.girl_nice,type:"voice",msg:t}),u((function(){O.list.nScrollToTop()}))):(F.items.push({id:2,avatar:B.avatar.caiman,type:"voice",msg:t}),F.items.push({id:1,avatar:B.avatar.girl_nice,type:"voice",msg:t}),u((function(){O.list.nScrollToBottom()})))}function tt(t){t==F.playingSrc?N.stop():(N.stop(),N.src=t,N.play())}function et(){F.plusVisible=!F.plusVisible,F.plusVisible?F.otherHeight=(F.kbH||120)-F.xh:F.otherHeight=0,F.emotionVisible=!1,F.voiceVisible=!1}function it(){v({url:"/pages/chat/collected"})}function ot(){F.emotionVisible=!F.emotionVisible,F.emotionVisible?F.otherHeight=160-F.xh:F.otherHeight=0,F.plusVisible=!1,F.voiceVisible=!1}function st(t){y("chatEmj",t)}function at(){y("chatDelEmj")}function nt(t){console.log(t),F.hasMorePage?(F.items.unshift({id:2,avatar:B.avatar.caiman,type:"text",msg:t}),F.items.unshift({id:1,avatar:B.avatar.girl_nice,type:"text",msg:t}),u((function(){O.list.nScrollToTop()}))):(F.items.push({id:2,avatar:B.avatar.caiman,type:"text",msg:t}),F.items.push({id:1,avatar:B.avatar.girl_nice,type:"text",msg:t}),u((function(){O.list.nScrollToBottom()}))),O.inputtoolbar.clear()}function rt(t){F.kbHeight=t.height,t.height>0&&(F.kbH=t.height,F.otherHeight=0,F.voiceVisible=!1,F.emotionVisible=!1,F.plusVisible=!1)}function lt(){setTimeout((()=>{F.items=k,F.hasMorePage=!0,function(t){const e=O.list;let i=e.nScrollToBottom;t&&(i=e.nScrollToTop);u((()=>{i()}))}(!0)}),2e3)}function ct(){F.hasMorePage&&setTimeout((()=>{F.items=F.items.concat(k.reverse());const t=O.list;5===t.nCurrentPage?t.nEndSuccess(!1):t.nEndSuccess(!0)}),2e3)}function mt(){F.moreVisible=!0}return x((()=>{F.platform=I(),F.hasMorePage="2"==U.type,F.xh=Z(),N.onEnded((()=>{F.playingSrc=""})),N.onPause((()=>{F.playingSrc=""})),N.onStop((()=>{F.playingSrc=""})),N.onPlay((()=>{F.playingSrc=N.src})),N.onError((()=>{F.playingSrc=""}))})),S((()=>{N.offEnded(),N.offPause(),N.offStop(),N.offPlay(),N.offError()})),(t,e)=>{const i=V(o("n-navbar"),d),u=n,f=V(o("n-list-cell"),j),v=V(o("n-list"),P),y=V(o("n-height"),H);return r(),s(u,null,{default:a((()=>[l(i,{lefts:c(R),title:"本人张翠花",rights:q,leftStyle:"width:90rpx;",centerStyle:"width:300rpx;justify-content:flex-start !important;",rightStyle:"width:360rpx;",onRightAction:W,onLeftAction:c(K)},null,8,["lefts","onLeftAction"]),l(v,{ref:t=>c(O).set(t,"list"),reverse:F.hasMorePage?"transform: rotateZ(180deg);":"",showScrollbar:!1,down:null,up:{use:F.hasMorePage},height:"window-!status-!nav-!x",onInited:lt,onUp:ct},{default:a((()=>[l(f,null,{default:a((()=>[l(u,{style:{height:"26rpx"}})])),_:1}),(r(!0),m(h,null,p(F.items,((e,i)=>(r(),s(f,{key:i},{default:a((()=>["text"==e.type?(r(),s(E,{key:0,boxStyle:F.hasMorePage?"transform: rotateZ(180deg);":"",isLeft:1===e.id,avatar:e.avatar,msg:e.msg,onMore:mt},null,8,["boxStyle","isLeft","avatar","msg"])):b("",!0),"image"==e.type?(r(),s(L,{key:1,boxStyle:F.hasMorePage?"transform: rotateZ(180deg);":"",isLeft:1===e.id,avatar:e.avatar,src:e.msg},null,8,["boxStyle","isLeft","avatar","src"])):b("",!0),"voice"==e.type?(r(),s(A,{key:2,boxStyle:F.hasMorePage?"transform: rotateZ(180deg);":"",isLeft:1===e.id,avatar:e.avatar,src:e.msg,current:t.playingSrc,onPlay:tt},null,8,["boxStyle","isLeft","avatar","src","current"])):b("",!0),l(u,{style:{height:"76rpx"}})])),_:2},1024)))),128))])),_:1},8,["reverse","up"]),l(T,{ref:t=>c(O).set(t,"inputtoolbar"),onKb:rt,onImage:G,onPlus:et,onEmotion:ot,onRecord:J,onConfirm:nt},null,512),l(u,{style:g({height:Q.value+"px"})},null,8,["style"]),l(y,{height:"x",bgType:"inverse"}),l(_,{show:F.voiceVisible,onShort:Y,onVoice:$,onCancel:X},null,8,["show"]),l(w,{show:F.plusVisible,height:F.kbH,onCollect:it},null,8,["show","height"]),l(M,{show:F.emotionVisible,onSelect:st,onDelete:at},null,8,["show"])])),_:1})}}};export{D as default};
