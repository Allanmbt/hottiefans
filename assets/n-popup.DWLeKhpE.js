import{r as e,c as a,J as t,d as l,w as o,n as u,H as n,m as v,f as s,i,o as r,N as p,b as c,e as f,O as m}from"./index-DyB-GtSf.js";import{m as b}from"./props.CkprGx8I.js";import{b as g,g as h}from"./system.Bdz65IDa.js";import{r as y}from"./uni-app.es.CYr7Wecl.js";const x={__name:"n-overlay",props:b([["show",!1],["hasAnimation",!0],["duration",400],["timingFunction",["ease-in","ease-out"]],["bgType","mask"],"bg",["canAutoClose",!0],["left","0"],["right","0"],["top","0"],["bottom","0"],"boxStyle","boxClass"]),emits:["overlayClicked","overlayClicking"],setup(c,{expose:f,emit:m}){const b=c,y=m;f({showOverlay:function(){x.value=!0},hideOverlay:function(){x.value=!1}});const x=e(!1),d=e(""),k=e(!1),C=e(null),O=a((()=>{let e="opacity:"+(b.hasAnimation?0:1)+";";return b.bg&&(e+=`background-color:${b.bg};`),e+=`left:${$.value}px;top:${w.value}px;right:${T.value}px;bottom:${A.value}px;`,e+b.boxStyle})),$=a((()=>g(b.left))),w=a((()=>h(b.top))),T=a((()=>g(b.right))),A=a((()=>h(b.bottom)));function _(e){b.canAutoClose?F(!1,b.duration,!0):y("overlayClicked",{}),e.stopPropagation&&e.stopPropagation()}function F(e,a=b.duration,t=!1){!function(e,a=b.duration,t=!1){const{hasAnimation:l,timingFunction:o,canAutoClose:u}=b;if(t)if(y("overlayClicking",{}),l){let t="opacity:0;";t+="transition: all "+a+"ms "+o[e?0:1]+";",d.value=t,k.value=!0,setTimeout((()=>{y("overlayClicked",{})}),a)}else y("overlayClicked",{});else if(!e&&k.value)x.value=!1;else{let t="opacity:"+(e?1:0)+";";t+="transition: all "+a+"ms "+o[e?0:1]+";",d.value=t,e||setTimeout((()=>{x.value=!1}),a)}}(e,a,t)}function S(e){e&&e.stopPropagation&&e.stopPropagation()}return t((()=>b.show),(e=>{!function(e,a){if(!e)return a&&(k.value=!0),void(x.value=a);a?(k.value=!1,x.value=!0,setTimeout((()=>{F(!0)}),40)):F(!1)}(b.hasAnimation,e)})),(e,a)=>{const t=i;return x.value?(r(),l(t,{key:0,class:u(["n-position-fixed","n-position-0","n-zindex-overlay","n-bg-"+e.bgType,e.boxClass]),ref_key:"noverlay",ref:C,onTouchmove:n(S,["stop"]),onClick:n(_,["stop"]),style:v(O.value+d.value)},{default:o((()=>[p(e.$slots,"default")])),_:3},8,["class","style"])):s("",!0)}}},d={__name:"n-popup",props:b([["show",!1],["pos","bottom"],"bgType",["duration",300],["hasOverlay",!0],["overlay",{hasAnimation:!0,timingFunction:["ease-in","ease-out"],duration:300,bg:"",bgType:"mask"}],["ani",{timingFunction:"ease-out"}],["baseWidth","750rpx"],["baseHeight","window"],["width","750rpx"],["height","0"],["leftOffset","-1"],["rightOffset","-1"],["bottomOffset","-1"],["topOffset","-1"],["left","0"],["right","0"],["top","0"],["bottom","0"],["delay",10],"boxStyle","overlayStyle","overlayClass","boxClass"]),emits:["overlayClicked"],setup(b,{emit:d}){const k=b,C=d,O=e(!1),$=e(!1),w=e(""),T=e(!1),A=e(null),_=a((()=>h(k.baseHeight))),F=a((()=>h(k.baseWidth))),S=a((()=>{let e={width:`${j.value}px`,height:`${P.value}px`};const a=k.pos;a.endsWith("center")&&("center"===a||"scale-center"===a?(Y.value<0&&W.value<0?e.top=.5*(_.value-P.value)+"px":Y.value>=0?e.top=.5*(_.value-P.value)+Y.value+"px":W.value>=0&&(e.top=.5*(_.value-P.value)-W.value+"px"),X.value<0&&H.value<0?e.left=.5*(F.value-j.value)+"px":X.value>=0?e.left=.5*(F.value-j.value)+X.value+"px":H.value>=0&&(e.left=.5*(F.value-j.value)-H.value+"px"),"center"===a&&(e.opacity=0),"scale-center"===a&&(e.transform="scale(0,0)")):"left-center"===a||"right-center"===a?(Y.value<0&&W.value<0?e.top=.5*(_.value-P.value)+"px":Y.value>=0?e.top=.5*(_.value-P.value)+Y.value+"px":W.value>=0&&(e.top=.5*(_.value-P.value)-W.value+"px"),"left-center"===a&&(e.left=-j.value+"px"),"right-center"===a&&(e.right=-j.value+"px")):"top-center"!==a&&"bottom-center"!==a||(e.left=.5*(F.value-j.value)+"px","top-center"===a&&(e.top=-P.value+"px"),"bottom-center"===a&&(e.bottom=-P.value+"px"))),"top"!==a&&"bottom"!==a||(X.value<0&&H.value<0?e.left=.5*(F.value-z.value-J.value-j.value)+"px":X.value>=0?e.left=z.value+X.value+"px":H.value>=0&&(e.right=J.value+H.value+"px"),"top"===a&&(e.top=-P.value+"px"),"bottom"===a&&(e.bottom=-P.value+"px")),"left"!==a&&"right"!==a||(Y.value<0&&W.value<0?e.top=.5*(_.value-q.value-K.value-P.value)+"px":Y.value>=0?e.top=q.value+Y.value+"px":W.value>=0&&(e.bottom=K.value+W.value+"px"),"left"===a&&(e.left=-j.value+"px"),"right"===a&&(e.right=-j.value+"px"));let t="";for(const l in e)t+=l+":"+e[l]+";";return t})),P=a((()=>{if(1*k.height>0&&1*k.height<=1)return _.value*(1*k.height);const e=h(k.height);return e>1?e:e<=0?_.value-q.value-K.value-(Y.value>=0?Y.value:0)-(W.value>=0?W.value:0):_.value*e})),j=a((()=>{const e=g(k.width);return e<=0?F.value-z.value-J.value-(X.value>=0?X.value:0)-(H.value>=0?H.value:0):e})),X=a((()=>"-1"===k.leftOffset?-1:g(k.leftOffset))),Y=a((()=>"-1"===k.topOffset?-1:h(k.topOffset))),H=a((()=>"-1"===k.rightOffset?-1:g(k.rightOffset))),W=a((()=>"-1"===k.bottomOffset?-1:h(k.bottomOffset))),z=a((()=>g(k.left))),q=a((()=>h(k.top))),J=a((()=>g(k.right))),K=a((()=>h(k.bottom)));function M(){T.value&&C("overlayClicked",{})}function N(e,a=k.duration){!function(e,a=k.duration){T.value=e;let t="transition-duration:"+a+"ms;";t+="transition-timing-function:"+k.ani.timingFunction+";","center"===k.pos?(t+="transition-property:opacity;",t+="opacity:"+(e?1:0)+";"):(t+="transition-property:transform;",t+="transform:"+function(e,a){let t=0,l="";switch(e){case"top":a||(t=P.value+q.value+(Y.value>=0?Y.value:0)),l=`translateY(${t}px)`;break;case"bottom":a||(t=P.value+K.value+(W.value>=0?W.value:0)),l=`translateY(-${t}px)`;break;case"left":a||(t=j.value+z.value+(X.value>=0?X.value:0)),l=`translateX(${t}px)`;break;case"right":a||(t=j.value+J.value+(H.value>=0?H.value:0)),l=`translateX(-${t}px)`;break;case"scale-center":l=a?"scale(0,0)":"scale(1,1)";break;case"left-center":a||(t=.5*(F.value+j.value)),l=`translateX(${t}px)`;break;case"right-center":a||(t=.5*(F.value+j.value)),l=`translateX(-${t}px)`;break;case"top-center":a||(Y.value<0&&W.value<0?t=.5*(_.value+P.value):Y.value>=0?t=.5*(_.value+P.value)+Y.value:W.value>=0&&(t=.5*(_.value+P.value)-W.value)),l=`translateY(${t}px)`;break;case"bottom-center":a||(Y.value<0&&W.value<0?t=.5*(_.value+P.value):Y.value>=0?t=.5*(_.value+P.value)-Y.value:W.value>=0&&(t=.5*(_.value+P.value)+W.value)),l=`translateY(-${t}px)`}return l}(k.pos,!e)+";");w.value=t,setTimeout((()=>{e||($.value=!1)}),a)}(e,a)}function B(e){e.stopPropagation&&e.stopPropagation()}return t((()=>k.show),(e=>{var a;(a=e)?(O.value=!0,m((()=>{$.value=!0,m((()=>{setTimeout((()=>{N(a)}),k.delay)}))}))):(O.value=!1,N(a))})),(e,a)=>{const t=y(c("n-overlay"),x),m=i;return r(),l(m,null,{default:o((()=>[f(m,null,{default:o((()=>[f(t,{show:e.hasOverlay&&O.value,bgType:e.overlay.bgType,bg:e.overlay.bg,duration:e.overlay.duration,hasAnimation:e.overlay.hasAnimation,timingFunction:e.overlay.timingFunction,canAutoClose:!1,left:e.left,top:e.top,right:e.right,bottom:e.bottom,boxStyle:e.overlayStyle,boxClass:e.overlayClass,onOverlayClicked:M},null,8,["show","bgType","bg","duration","hasAnimation","timingFunction","left","top","right","bottom","boxStyle","boxClass"])])),_:1}),$.value?(r(),l(m,{key:0,ref_key:"npopup",ref:A,onTouchmove:n(B,["stop"]),onClick:n(B,["stop"]),class:u(["n-position-fixed","n-zindex-pop","n-width-750rpx","n-flex-column","n-bg-"+e.bgType,e.boxClass]),style:v(e.boxStyle+S.value+w.value)},{default:o((()=>[p(e.$slots,"default")])),_:3},8,["class","style"])):s("",!0)])),_:3})}}};export{d as _};
