import{I as t,c as a,K as e,o as n,k as i,F as s,l as o,M as r,O as c,m as l,y as p,e as d,w as u,h as f,t as m,q as g,p as h,r as v,b as x,j as y,ap as k}from"./index-DyB-GtSf.js";import{_ as w}from"./n-navbar.DgJOiXYI.js";import{r as b}from"./uni-app.es.CYr7Wecl.js";import{c as _}from"./imgs.wUGTdslH.js";import{u as P}from"./useNav.y5ABEmWP.js";import{g as j,a as T}from"./element.B9OwrRfy.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./n-icon.C34IfF9H.js";import"./props.CkprGx8I.js";import"./n-badge.U9JWwHKe.js";import"./system.Bdz65IDa.js";const C=I({__name:"flipcard",props:{pages:{type:Array,default:()=>[]},stackInit:{type:Object,default:()=>({})}},emits:["click"],setup(v,{expose:x,emit:y}){const k=v,w=y;x({prev:function(){I.tracking=!1,I.animation=!0;let t=_.width;I.poswidth=-t,I.posheight=0,I.opacity=0,I.rotate="-3",I.swipe=!0,S()},next:function(){I.tracking=!1,I.animation=!0;let t=_.width;I.poswidth=t,I.posheight=0,I.opacity=0,I.rotate="3",I.swipe=!0,S()}});const{proxy:b}=r(),_=t({width:0,height:0,top:0}),P=t({start:{t:0,x:0,y:0},end:{t:0,x:0,y:0}}),I=t({isStackClick:!0,offsetY:"",poswidth:0,posheight:0,lastPosWidth:"",lastPosHeight:"",lastZindex:"",rotate:0,lastRotate:0,visible:k.stackInit.visible||3,tracking:!1,animation:!1,currentPage:k.stackInit.currentPage||0,opacity:1,lastOpacity:0,swipe:!1,zIndex:10}),C=a((()=>{let t=_.width,a=_.height,e=1-(t-Math.abs(I.poswidth))*(a-Math.abs(I.posheight))/(t*a)||0;return e>1?1:e})),D=a((()=>{let t=_.width;return 1-(t-Math.abs(I.poswidth))/t||0}));function F(t){if(I.tracking)return;const a=T(t);if("touchstart"===t.type){if(t.touches.length>1)return void(I.tracking=!1);P.start.t=(new Date).getTime(),P.start.x=a.x,P.start.y=a.y,P.end.x=a.x,P.end.y=a.y,I.offsetY=a.y-_.top}I.isStackClick=!0,I.tracking=!0,I.animation=!1}function M(t){if(I.isStackClick=!1,I.tracking&&!I.animation){const a=T(t);t.preventDefault(),P.end.x=a.x,P.end.y=a.y,I.poswidth=P.end.x-P.start.x,I.posheight=P.end.y-P.start.y;const e=I.poswidth<=0?-1:1,n=function(){let t=_.height;return-1*(2*I.offsetY/t-1)||0}();I.rotate=e*D.value*15*n}}function O(t,a){if(I.isStackClick&&(w("click",a),I.isStackClick=!1),I.isStackClick=!0,I.tracking=!1,I.animation=!0,C.value>=.4){let t=Math.abs(I.posheight/I.poswidth);I.poswidth=I.poswidth>=0?I.poswidth+200:I.poswidth-200,I.posheight=I.posheight>=0?Math.abs(I.poswidth*t):-Math.abs(I.poswidth*t),I.opacity=0,I.swipe=!0,S()}else I.poswidth=0,I.posheight=0,I.swipe=!1,I.rotate=0}function S(){I.lastPosWidth=I.poswidth,I.lastPosHeight=I.posheight,I.lastRotate=I.rotate,I.lastZindex=20,I.currentPage=I.currentPage===k.pages.length-1?0:I.currentPage+1,c((()=>{I.poswidth=0,I.posheight=0,I.opacity=1,I.rotate=0}))}function z(t){let a=I.currentPage,e=k.pages.length,n=0===a?k.pages.length-1:a-1,i={},s=I.visible;if(t!==I.currentPage){if(function(t,a){let e=[],n=I.visible,i=k.pages.length;for(let s=0;s<n;s++)a+s<i?e.push(a+s):e.push(a+s-i);return e.indexOf(t)>=0}(t,a)){let n=t-a>0?t-a:t-a+e;i.opacity="1",i.transform="translate3D(0,0,"+-60*(n-C.value)+"px)",i.zIndex=s-n,I.tracking||(i.transitionTimingFunction="ease",i.transitionDuration="300ms")}else t===n?(i.transform="translate3D("+I.lastPosWidth+"px,"+I.lastPosHeight+"px,0px) rotate("+I.lastRotate+"deg)",i.opacity=I.lastOpacity,i.zIndex=I.lastZindex,i.transitionTimingFunction="ease",i.transitionDuration="300ms"):(i.zIndex="-1",i.transform="translate3D(0,0,"+-1*s*60+"px)");return i}}function R(t){if(t===I.currentPage){let t={};return t.transform="translate3D("+I.poswidth+"px,0px,0px) rotate("+-I.rotate+"deg)",t.opacity=I.opacity,t.zIndex=10,I.animation&&(t.transitionTimingFunction="ease",t.transitionDuration=(I.animation?300:0)+"ms"),t}}return e((async()=>{await j("flipcard",!0,b)})),(t,a)=>{const e=g,r=h;return n(),i("div",{class:"flipcard",id:"flipcard",ref:"flipcard"},[(n(!0),i(s,null,o(v.pages,((t,a)=>(n(),i("div",{class:"flipcard-item",key:a,style:l([R(a),z(a)]),onTouchstart:F,onTouchmove:M,onTouchend:O,onTouchcancel:O,onTransitionend:t=>function(t){let a=0===I.currentPage?k.pages.length-1:I.currentPage-1;I.swipe&&t===a&&(I.animation=!0,I.lastPosWidth=0,I.lastPosHeight=0,I.lastOpacity=0,I.lastRotate=0,I.swipe=!1,I.lastZindex=-1)}(a)},[p("div",{class:"flipcard-item-stack-info"},[p("div",{class:"flipcard-item-stack-info-t3"},[d(e,{class:"flipcard-item-stack-info-t3-text"},{default:u((()=>[f(m(t.tag),1)])),_:2},1024)]),p("div",{class:"flipcard-item-stack-info-problem"},[d(e,{class:"flipcard-item-stack-info-problem-text"},{default:u((()=>[f(m(t.problem),1)])),_:2},1024)]),p("div",{class:"flipcard-item-stack-info-desc n-flex-row n-wrap-nowrap n-align-center"},[d(e,{class:"flipcard-item-stack-info-desc-text"},{default:u((()=>[f(m(t.attention_num)+"人关注",1)])),_:2},1024),d(e,{class:"flipcard-item-stack-info-desc-text"},{default:u((()=>[f("·")])),_:1}),d(e,{class:"flipcard-item-stack-info-desc-text"},{default:u((()=>[f(m(t.comment_num)+"人回答",1)])),_:2},1024)]),p("div",{class:"n-flex-row n-wrap-nowrap n-align-center n-position-absolute flipcard-item-stack-info-bottom-box"},[d(r,{class:"flipcard-item-stack-info-bottom-box-avatar",src:t.author.avatar,mode:"aspectFill"},null,8,["src"]),d(e,{class:"flipcard-item-stack-info-bottom-box-name"},{default:u((()=>[f(m(t.author.name),1)])),_:2},1024)])])],44,["onTransitionend"])))),128))],512)}}},[["__scopeId","data-v-54c14c2f"]]),D=I({__name:"card-overlay",setup(t){const{leftIcons:a,navLeftAction:e}=P(),s=[{icon:"",text:"稍后答（10）",textStyle:"font-size:28rpx;color:#FFF;",style:""}],o=[{tag:"最近83人提问过这个问题11111",problem:"关于陈红军壮烈牺牲的报道，陈红军的“发小”王煦辉这几天看了一遍又一遍，从小玩到大的伙伴如今已经天人相隔，让他至今也无法接受。在同学眼中，陈红军打小就是一位品学兼优的好子，就是这个家境贫寒的农村娃，考上了城里的高？",author:{id:1,name:"一颗棒棒糖",avatar:"/static/logo-dark.png"},comment_num:5160,dig_num:5160,forward_num:5160,attention_num:30},{tag:"最近83人提问过这个问题22222",problem:"关于陈红军壮烈牺牲的报道，陈红军的“发小”王煦辉这几天看了一遍又一遍，从小玩到大的伙伴如今已经天人相隔，让他至今也无法接受。在同学眼中，陈红军打小就是一位品学兼优的好子，就是这个家境贫寒的农村娃，考上了城里的高？",author:{id:1,name:"两颗棒棒糖",avatar:_.avatar.caiman},comment_num:5160,dig_num:5160,forward_num:5160,attention_num:30},{tag:"最近83人提问过这个问题33333",problem:"关于陈红军壮烈牺牲的报道，陈红军的“发小”王煦辉这几天看了一遍又一遍，从小玩到大的伙伴如今已经天人相隔，让他至今也无法接受。在同学眼中，陈红军打小就是一位品学兼优的好子，就是这个家境贫寒的农村娃，考上了城里的高？",author:{id:1,name:"三颗棒棒糖",avatar:_.avatar.dog},comment_num:5160,dig_num:5160,forward_num:5160,attention_num:30},{tag:"最近83人提问过这个问题44444",problem:"关于陈红军壮烈牺牲的报道，陈红军的“发小”王煦辉这几天看了一遍又一遍，从小玩到大的伙伴如今已经天人相隔，让他至今也无法接受。在同学眼中，陈红军打小就是一位品学兼优的好子，就是这个家境贫寒的农村娃，考上了城里的高？",author:{id:1,name:"四颗棒棒糖",avatar:_.avatar.pikaqiu},comment_num:5160,dig_num:5160,forward_num:5160,attention_num:30}],r={currentPage:0,visible:3},c=v(o),l=v(null);function m(){k({title:"惊喜",content:"卡片数量3个以及3个以上，交互效果不一样哦",cancelText:"我不体验",confirmText:"体验一下",success:t=>{t.confirm?c.value=o.slice(0,3):c.value=o},fail:()=>{},complete:()=>{}})}function j(){console.log("卡片点击事件")}function T(){l.value.prev()}function I(){l.value.next()}return(t,o)=>{const v=b(x("n-navbar"),w),k=h,P=g;return n(),i("div",{class:"n-full-height n-bg-primary card-overlay"},[d(v,{bgType:"primary",lefts:y(a),rights:s,title:"",itemIconType:"inverse",titleType:"inverse",onLeftAction:y(e)},null,8,["lefts","onLeftAction"]),p("div",{class:"card-overlay-stack"},[d(C,{ref_key:"stack",ref:l,pages:c.value,stackInit:r,onClick:j},null,8,["pages"])]),p("div",{class:"card-overlay-btns n-flex-row n-wrap-nowrap n-align-center n-justify-center"},[p("div",{class:"n-flex-column n-align-center",onClick:T},[p("div",{class:"card-overlay-btns-box n-flex-row n-justify-center n-align-center"},[d(k,{class:"card-overlay-btns-img",src:y(_).avatar.pig},null,8,["src"])]),d(P,{class:"card-overlay-btns-text"},{default:u((()=>[f("不感兴趣")])),_:1})]),p("div",{class:"n-flex-column n-align-center",onClick:m},[p("div",{class:"card-overlay-btns-box n-flex-row n-justify-center n-align-center"},[d(k,{class:"card-overlay-btns-img",src:y(_).avatar.caiman},null,8,["src"])]),d(P,{class:"card-overlay-btns-text"},{default:u((()=>[f("写回答")])),_:1})]),p("div",{class:"n-flex-column n-align-center",onClick:I},[p("div",{class:"card-overlay-btns-box n-flex-row n-justify-center n-align-center"},[d(k,{class:"card-overlay-btns-img",src:y(_).avatar.bear},null,8,["src"])]),d(P,{class:"card-overlay-btns-text"},{default:u((()=>[f("稍后答")])),_:1})])])])}}},[["__scopeId","data-v-f29f878e"]]);export{D as default};
