import{_ as a,r as e,K as l,d as s,w as t,i as u,o as d,e as i,h as r,k as n,l as c,F as o,t as v,f as m,P as f,a6 as p,q as _}from"./index-DyB-GtSf.js";import{c as h}from"./index.CKrUohZX.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const g=h("https://ahskvynwbuhdlanyzgmi.supabase.co/functions/v1/","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFoc2t2eW53YnVoZGxhbnl6Z21pIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDAyNTAxMjUsImV4cCI6MjA1NTgyNjEyNX0.S-96iGeLelGyqsgNgJHOqCzHFwMgysBRSDZAhn02vjg"),I=g.supabaseUrl+"users",k=g.supabaseKey,b={fetchUsers:async(e=1,l=10,s="")=>(await a({url:`${I}/list`,method:"POST",header:{Authorization:`Bearer ${k}`},data:{page:e,pageSize:l,searchName:s}})).data,createUser:async e=>(await a({url:`${I}/create`,method:"POST",header:{Authorization:`Bearer ${k}`},data:{username:e}})).data,updateUser:async(e,l)=>(await a({url:`${I}/update`,method:"PUT",header:{Authorization:`Bearer ${k}`},data:{id:e,username:l}})).data,deleteUser:async e=>(await a({url:`${I}/delete`,method:"DELETE",header:{Authorization:`Bearer ${k}`},data:{id:e}})).data},C=y({__name:"test",setup(a){const h=e([]),y=e(!0),g=e(1),I=e(""),k=e(!1),C=e(""),U=e(null),w=async()=>{y.value=!0,h.value=await b.fetchUsers(g.value,10,I.value),y.value=!1},z=()=>{g.value=1,w()},A=()=>{g.value>1&&(g.value--,w())},N=()=>{g.value++,w()},S=()=>{C.value="",U.value=null,k.value=!0},V=()=>{k.value=!1,U.value=null},j=async()=>{C.value.trim()&&(U.value?await b.updateUser(U.value.id,C.value):await b.createUser(C.value),V(),w())};return l(w),(a,e)=>{const l=u,J=f,$=p,x=_;return d(),s(l,{class:"container"},{default:t((()=>[i(l,{class:"title"},{default:t((()=>[r("User List")])),_:1}),i(l,{class:"search-bar"},{default:t((()=>[i(J,{modelValue:I.value,"onUpdate:modelValue":e[0]||(e[0]=a=>I.value=a),placeholder:"Search Name",onInput:z},null,8,["modelValue"]),i($,{class:"add-btn",onClick:S},{default:t((()=>[r("Add")])),_:1})])),_:1}),y.value?(d(),s(l,{key:0,style:{"margin-top":"30rpx"}},{default:t((()=>[r("loading...")])),_:1})):(d(),s(l,{key:1},{default:t((()=>[(d(!0),n(o,null,c(h.value,(a=>(d(),s(l,{key:a.id,class:"user-card"},{default:t((()=>[i(x,{class:"name"},{default:t((()=>[r(v(a.username),1)])),_:2},1024),i(x,{class:"time"},{default:t((()=>{return[r("CreateTime："+v((e=a.created_at,new Date(e).toLocaleString())),1)];var e})),_:2},1024),i(l,{class:"actions"},{default:t((()=>[i($,{class:"edit-btn",onClick:e=>(a=>{C.value=a.username,U.value=a,k.value=!0})(a)},{default:t((()=>[r("Edit")])),_:2},1032,["onClick"]),i($,{class:"delete-btn",onClick:e=>(async a=>{confirm("确认删除该用户？")&&(await b.deleteUser(a),w())})(a.id)},{default:t((()=>[r("Del")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})),i(l,{class:"pagination"},{default:t((()=>[i($,{onClick:A,disabled:g.value<=1},{default:t((()=>[r("上一页")])),_:1},8,["disabled"]),i($,{onClick:N},{default:t((()=>[r("下一页")])),_:1})])),_:1}),k.value?(d(),s(l,{key:2,class:"dialog-overlay"},{default:t((()=>[i(l,{class:"dialog"},{default:t((()=>[i(x,{class:"dialog-title"},{default:t((()=>[r(v(U.value?"修改用户":"新增用户"),1)])),_:1}),i(J,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=a=>C.value=a),placeholder:"输入用户名"},null,8,["modelValue"]),i(l,{class:"dialog-actions"},{default:t((()=>[i($,{class:"confirm-btn",onClick:j},{default:t((()=>[r("确认")])),_:1}),i($,{class:"cancel-btn",onClick:V},{default:t((()=>[r("取消")])),_:1})])),_:1})])),_:1})])),_:1})):m("",!0)])),_:1})}}},[["__scopeId","data-v-187fcace"]]);export{C as default};
